var Students = {
  "HashemBuzer": {
    "pastPairs": [
      "OmarBara",
      "BilelGharbi"
    ],
    "Solo": false
  },
  "OmarBara": {
    "pastPairs": [
      "HashemBuzer",
      "HeniMezrani"
    ],
    "Solo": false
  },
  "MohamedAmineAouini": {
    "pastPairs": [
      "HaniaLazreg",
      "AliJalal"
    ],
    "Solo": false
  },
  "HaniaLazreg": {
    "pastPairs": [
      "MohamedAmineAouini",
      "JihedAbdelly"
    ],
    "Solo": false
  },
  "MohamedBelkheir": {
    "pastPairs": [
      "MehdiFarjallah",
      "HamamElmurtdh"
    ],
    "Solo": True
  },
  "MehdiFarjallah": {
    "pastPairs": [
      "MohamedBelkheir",
      "FirasAmous"
    ],
    "Solo": false
  },
  "AbdelsalamShahlol": {
    "pastPairs": [
      "MohamedFared",
      "OnsRahmani"
    ],
    "Solo": false
  },
  "MohamedFared": {
    "pastPairs": [
      "AbdelsalamShahlol",
      "ZiedBarhoumi"
    ],
    "Solo": false
  },
  "FirasAmous": {
    "pastPairs": [
      "HamamElmurtdh",
      "MehdiFarjallah"
    ],
    "Solo": false
  },
  "HamamElmurtdh": {
    "pastPairs": [
      "FirasAmous",
      "MohamedBelkheir"
    ],
    "Solo": false
  },
  "ZiedBarhoumi": {
    "pastPairs": [
      "HeniMezrani",
      "MohamedFared"
    ],
    "Solo": false
  },
  "HeniMezrani": {
    "pastPairs": [
      "ZiedBarhoumi",
      "OmarBara"
    ],
    "Solo": false
  },
  "SalimAliAlsaeh": {
    "pastPairs": [
      "AliJalal",
      "MohamedSbeta"
    ],
    "Solo": false
  },
  "AliJalal": {
    "pastPairs": [
      "SalimAliAlsaeh",
      "MohamedAmineAouini"
    ],
    "Solo": false
  },
  "OnsRahmani": {
    "pastPairs": [
      "NejahSafi",
      "AbdelsalamShahlol"
    ],
    "Solo": false
  },
  "NejahSafi": {
    "pastPairs": [
      "OnsRahmani",
      "FoozBarakat"
    ],
    "Solo": false
  },
  "HoudaRouaissi": {
    "pastPairs": [
      "FoozBarakat",
      "MaherBouzid"
    ],
    "Solo": false
  },
  "FoozBarakat": {
    "pastPairs": [
      "HoudaRouaissi",
      "NejahSafi"
    ],
    "Solo": false
  },
  "JihedAbdelly": {
    "pastPairs": [
      "MaherBouzid",
      "HaniaLazreg"
    ],
    "Solo": false
  },
  "MaherBouzid": {
    "pastPairs": [
      "JihedAbdelly",
      "HoudaRouaissi"
    ],
    "Solo": false
  },
  "MalikAbdullah": {
    "pastPairs": [
      "HamzaDanden",
      "TahaZnazen"
    ],
    "Solo": false
  },
  "HamzaDanden": {
    "pastPairs": [
      "MalikAbdullah",
      "FaresJelassi"
    ],
    "Solo": false
  },
  "FaresJelassi": {
    "pastPairs": [
      "TahaZnazen",
      "HamzaDanden"
    ],
    "Solo": false
  },
  "TahaZnazen": {
    "pastPairs": [
      "FaresJelassi",
      "MalikAbdullah"
    ],
    "Solo": True
  },
  "KhoubaiebGhaouari": {
    "pastPairs": [
      "WajdiHamrouni",
      "MuftahElzawi"
    ],
    "Solo": false
  },
  "WajdiHamrouni": {
    "pastPairs": [
      "KhoubaiebGhaouari",
      "FatimaMabrook"
    ],
    "Solo": false
  },
  "AubaArifElwahieshi": {
    "pastPairs": [
      "AmeraAyad",
      "TahaMejri"
    ],
    "Solo": false
  },
  "AmeraAyad": {
    "pastPairs": [
      "AubaArifElwahieshi",
      "FaroukGuizeni"
    ],
    "Solo": false
  },
  "FaroukGuizeni": {
    "pastPairs": [
      "TahaMejri",
      "AmeraAyad"
    ],
    "Solo": false
  },
  "TahaMejri": {
    "pastPairs": [
      "FaroukGuizeni",
      "AubaArifElwahieshi"
    ],
    "Solo": false
  },
  "FatimaMabrook": {
    "pastPairs": [
      "AnasMarzouki",
      "WajdiHamrouni"
    ],
    "Solo": false
  },
  "AnasMarzouki": {
    "pastPairs": [
      "FatimaMabrook"
    ],
    "Solo": True
  },
  "AbdoAlabed": {
    "pastPairs": [
      "MohamedAmineSlaimia",
      "MohamedAmineSlaimia"
    ],
    "Solo": false
  },
  "MohamedAmineSlaimia": {
    "pastPairs": [
      "AbdoAlabed",
      "AbdoAlabed"
    ],
    "Solo": false
  },
  "MohamedDhiaWeslati": {
    "pastPairs": [
      "AhmedWheida",
      "EssamFaraj"
    ],
    "Solo": false
  },
  "AhmedWheida": {
    "pastPairs": [
      "MohamedDhiaWeslati",
      "AdnenBenAbdelaali"
    ],
    "Solo": false
  },
  "DhiaRaissi": {
    "pastPairs": [
      "AdamMomen",
      "SofianSaleh"
    ],
    "Solo": false
  },
  "AdamMomen": {
    "pastPairs": [
      "DhiaRaissi",
      "AbdulrahmanShibani"
    ],
    "Solo": false
  },
  "AbdulrahmanShibani": {
    "pastPairs": [
      "SofianSaleh",
      "AdamMomen"
    ],
    "Solo": false
  },
  "SofianSaleh": {
    "pastPairs": [
      "AbdulrahmanShibani",
      "DhiaRaissi"
    ],
    "Solo": false
  },
  "EssamFaraj": {
    "pastPairs": [
      "MuftahElzawi",
      "MohamedDhiaWeslati"
    ],
    "Solo": false
  },
  "MuftahElzawi": {
    "pastPairs": [
      "EssamFaraj",
      "KhoubaiebGhaouari"
    ],
    "Solo": false
  },
  "InsafMechergui": {
    "pastPairs": [
      "LinaBenSalem",
      "LinaBenSalem"
    ],
    "Solo": false
  },
  "LinaBenSalem": {
    "pastPairs": [
      "InsafMechergui",
      "InsafMechergui"
    ],
    "Solo": false
  },
  "AdnenBenAbdelaali": {
    "pastPairs": [
      "BilelGharbi",
      "MohamedSbeta",
      "AhmedWheida"
    ],
    "Solo": false
  },
  "BilelGharbi": {
    "pastPairs": [
      "AdnenBenAbdelaali",
      "MohamedSbeta",
      "HashemBuzer"
    ],
    "Solo": false
  },
  "MohamedSbeta": {
    "pastPairs": [
      "BilelGharbi",
      "AdnenBenAbdelaali",
      "SalimAliAlsaeh"
    ],
    "Solo": false
  }
}

function each(coll, f) {
  if (Array.isArray(coll)) {
    for (var i = 0; i < coll.length; i++) {
      f(coll[i], i);
    }
  } else {
    for (var key in coll) {
      f(coll[key], key);
    }
  }
}

function filter(array, predicate) {
  var acc = [];
  each(array, function(element, i) {
    if (predicate(element, i)) {
      acc.push(element);
    }
  });
  return acc;
}

function filterOut(studentList,pairsList){
    var arr = studentList;
	return filter(arr,function(element){
	   return pairsList.includes(element) === false;
	})
}

function chosePair(student,listOfStudents){
	var arr = filterOut(listOfStudents,Students[student].pastPairs);
	arr.splice(arr.indexOf(student),1)
	return [student, arr[Math.floor(Math.random() * Math.floor(arr.length))]];
}

function addToPastpairs (arr){
	Students[arr[0]].pastPairs.push(arr[1])
	Students[arr[1]].pastPairs.push(arr[0])
}

function findSolo(obj){
	var arr = filter (Object.keys(obj),function(element){
		return Students[element].Solo === false;
	})
	var sadPerson = arr[Math.floor(Math.random() * Math.floor(arr.length))];
	Students[sadPerson].Solo = true;
	return [sadPerson,'solo'];	
}

function pairing(studnetData) {

	var list = Object.keys(studnetData);
	var pairs = [];
	if(list.length % 2 === 1){
		pairs.push(findSolo(Students));
		list.splice(pairs[0],1);
	}
	while(list.length > 0){
		var arr = chosePair(list[0],list);
		addToPastpairs(arr)
		list.splice(0,1)
		list.splice(list.indexOf(arr[1]),1)
		pairs.push(arr);
	}
  	
  	return pairs;
} 